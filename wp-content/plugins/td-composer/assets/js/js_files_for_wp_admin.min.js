var tdcWindowFrame;
(function(b,d){tdcWindowFrame={_isInitialized:!1,_arrCssSelectors:[],_inMoving:!1,_inResizing:!1,$_currentWindowFrame:d,$_tdcIframeCover:d,$_tdcSidebar:d,$_window:d,_currentWindowPosition:d,_lastZIndex:1E3,_resizeOffset:d,_markerCssClass:"tdc-window-frame",init:function(a){if(!tdcWindowFrame._isInitialized){tdcWindowFrame._arrCssSelectors=a;tdcWindowFrame.$_window=b(window);tdcWindowFrame.$_tdcIframeCover=b("#tdc-iframe-cover");tdcWindowFrame.$_tdcSidebar=b("#tdc-sidebar");for(var c=b("body"),e="",
l="",g=0;g<a.length;g++){var h=a[g]+" > header",f=a[g]+" .tdw-resize";0!==g&&(h=","+h,f=","+f);e+=h;l+=f;b(a[g]).on("mousedown",function(a){a=b(this);a.hasClass("tdw-inactive")&&tdcWindowFrame.setWindowFrame(a)})}c.on("mousedown",e,function(a){a.currentTarget===a.target&&(tdcWindowFrame.$_currentWindowFrame=b(a.currentTarget).parent(),tdcWindowFrame.setWindowFrame(tdcWindowFrame.$_currentWindowFrame),tdcWindowFrame._inMoving=!0,tdcWindowFrame.setCurrentWindowFramePosition(a),tdcWindowFrame.setMouseInitialPosition({left:a.pageX,
top:a.pageY}),tdcWindowFrame._disableCurrentWindowContent())}).on("mouseup",e,function(a){a.currentTarget===a.target&&(tdcWindowFrame._inMoving=!1,tdcWindowFrame.setCurrentWindowFramePosition(a),tdcWindowFrame.setMouseInitialPosition(d),tdcWindowFrame._disableBackground(!1),tdcWindowFrame._enableCurrentWindowContent())}).on("mouseup",function(a){tdcWindowFrame._inMoving=!1;tdcWindowFrame._inResizing=!1;tdcWindowFrame.setCurrentWindowFramePosition(a);tdcWindowFrame.setMouseInitialPosition({left:a.pageX,
top:a.pageY});tdcWindowFrame._resizeOffset=d;tdcWindowFrame._disableBackground(!1)}).on("mousemove",function(a){b(this);if(tdcWindowFrame._inMoving){a.stopPropagation();a.preventDefault();var c=tdcWindowFrame.getMouseInitialPosition();if("undefined"!==typeof c){var e=tdcWindowFrame.getCurrentWindowFramePosition();tdcWindowFrame.$_currentWindowFrame.css({left:a.pageX-(c.left-e.left),top:a.pageY-(c.top-e.top)});tdcWindowFrame.$_currentWindowFrame.addClass("clear-position");tdcWindowFrame._disableBackground()}}else if(tdcWindowFrame._inResizing&&
(a.stopPropagation(),a.preventDefault(),c=tdcWindowFrame.getMouseInitialPosition(),"undefined"!==typeof c)){var k={offsetLeft:0,offsetTop:0};_.isUndefined(tdcWindowFrame._resizeOffset)||(k=tdcWindowFrame._resizeOffset);e=tdcWindowFrame.getCurrentWindowFramePosition();c=a.pageX-e.left+k.width-k.offsetLeft;a=a.pageY-e.top+k.height-k.offsetTop;tdcWindowFrame.$_currentWindowFrame.css({width:c,height:a});tdcWindowFrame.$_currentWindowFrame.data("width",c);tdcWindowFrame.$_currentWindowFrame.data("height",
a);tdcWindowFrame._timerResize=setTimeout(function(){"undefined"!==typeof tdcWindowFrame._timerResize&&(clearTimeout(tdcWindowFrame._timerResize),editor.resize(!0))},100);tdcWindowFrame._disableBackground()}}).on("mousedown",l,function(a){if(a.currentTarget===a.target){var c=b(a.currentTarget);tdcWindowFrame.$_currentWindowFrame=b(a.currentTarget).closest("."+tdcWindowFrame._markerCssClass);tdcWindowFrame.setWindowFrame(tdcWindowFrame.$_currentWindowFrame);tdcWindowFrame._inResizing=!0;tdcWindowFrame.setCurrentWindowFramePosition(a);
tdcWindowFrame.setMouseInitialPosition({left:a.pageX,top:a.pageY});tdcWindowFrame._resizeOffset={width:c.width(),height:c.height(),offsetLeft:a.pageX-c.offset().left,offsetTop:a.pageY-c.offset().top}}}).on("mouseup",l,function(a){a.currentTarget===a.target&&(tdcWindowFrame._inResizing=!1,tdcWindowFrame.setMouseInitialPosition(d),tdcWindowFrame._disableBackground(!1),tdcWindowFrame._resizeOffset=d)}).on("click",".tdw-css-writer-expand .tdw-expand-collapse, .tdw-close, .tdc-iframe-close-button",function(a){a.currentTarget===
a.target&&(a=b(a.currentTarget).closest(".tdc-window-frame"),"tdw-css-writer"!==a.attr("id")&&(a.removeClass("clear-position"),a.css({left:"",top:""})),tdcWindowFrame.unsetWindowFrame(a))}).on("mousedown",".tdc-window-frame",function(a){a=b(a.currentTarget);a.hasClass("tdw-inactive")&&tdcWindowFrame.setWindowFrame(a)});tdcWindowFrame.$_window.on("resize",function(){b("."+tdcWindowFrame._markerCssClass).each(function(a,c){a=b(c);c={};var e=a.offset();e.left+100>tdcWindowFrame.$_window.width()&&(c.left=
tdcWindowFrame.$_window.width()-100);e.top+100>tdcWindowFrame.$_window.height()&&(c.top=tdcWindowFrame.$_window.height()-100);b.isEmptyObject(c)||a.css(c)});"undefined"!==typeof tdcContextMenu&&tdcContextMenu.hide()});tdcWindowFrame._isInitialized=!0}},getCurrentWindowFramePosition:function(){return tdcWindowFrame._currentWindowPosition},setCurrentWindowFramePosition:function(a){tdcWindowFrame._currentWindowPosition="undefined"===typeof tdcWindowFrame.$_currentWindowFrame?d:tdcWindowFrame.$_currentWindowFrame.offset()},
setMouseInitialPosition:function(a){tdcWindowFrame._mouseInitialPosition=a},getMouseInitialPosition:function(){return tdcWindowFrame._mouseInitialPosition},_disableBackground:function(a){"undefined"!==typeof a&&!1===a?tdcWindowFrame.$_tdcIframeCover.removeClass("tdc-iframe-cover-transparent"):tdcWindowFrame.$_tdcIframeCover.addClass("tdc-iframe-cover-transparent")},_enableCurrentWindowContent:function(){"undefined"!==typeof tdcWindowFrame.$_currentWindowFrame&&tdcWindowFrame.$_currentWindowFrame.find(".content").css("pointer-events",
"")},_disableCurrentWindowContent:function(){"undefined"!==typeof tdcWindowFrame.$_currentWindowFrame&&tdcWindowFrame.$_currentWindowFrame.find(".content").css("pointer-events","none")},setWindowFrame:function(a){b("."+tdcWindowFrame._markerCssClass).addClass("tdw-inactive");a.addClass(tdcWindowFrame._markerCssClass);tdcWindowFrame.$_tdcIframeCover.css({"z-index":++tdcWindowFrame._lastZIndex});a.css({"z-index":++tdcWindowFrame._lastZIndex});a.removeClass("tdw-inactive")},unsetWindowFrame:function(a){a.removeClass(tdcWindowFrame._markerCssClass);
setTimeout(function(){tdcWindowFrame.activeLastWindowFrame()},50)},activeLastWindowFrame:function(){var a=d,c=-1;b("."+tdcWindowFrame._markerCssClass).each(function(e,d){e=b(d);d=parseInt(e.css("z-index"));d>c&&(c=d,a=e)});"undefined"!==typeof a&&a.removeClass("tdw-inactive")},getMarkerCssClass:function(){return tdcWindowFrame._markerCssClass}};b(window).load(function(){tdcWindowFrame.init(["#tdw-css-writer","#tdc-menu-settings","#tdc-page-settings","#tdc-wpeditor","#tdc-zone"])})})(jQuery);var tdcNotice;
(function(b,d){tdcNotice={$_noticeWrapper:d,_isInitialized:!1,_errorNotices:[],inError:!1,notice:function(a,c,b){var e={};_.isUndefined(c)||!0!==c||(e.type="error");_.isUndefined(b)||!0!==b||(e.hasClose=!0);tdcNotice.showNotice(a,e)},showNotice:function(a,c){if(tdcNotice._isInitialized){var e="",d="",g=!1,h=5E3;if("undefined"!==typeof c){if("undefined"!==typeof c.type)switch(c.type){case "error":e="tdc-notice-error";g=!0;break;case "info":e="tdc-notice-info"}"undefined"!==typeof c.hasClose&&!0===
c.hasClose&&(d='<div class="tdc-close-notice"></div>');"undefined"!==typeof c.timeout&&(h=c.timeout)}g&&(a+=" Current state has involved an issue. You could try an UNDO operation (CTRL+Z / CTRL+SHIFT+Z)");var f=b('<div class="tdc-notice '+e+'"><span class="tdc-msg-tag"></span>'+a+d+"</div>");tdcNotice.$_noticeWrapper.append(f);setTimeout(function(){f.addClass("tdc-notice-in")},100);if(g)throw tdcNotice._errorNotices.push(f),tdcNotice.inError=!0,tdcRecycle.init(),b("body").addClass("tdcComposerLoaded"),
a;setTimeout(function(){f.removeClass("tdc-notice-in")},h-1E3);setTimeout(function(){f.css("margin-top","-"+f.outerHeight()+"px")},h-500);setTimeout(function(){f.remove()},h)}},removeAll:function(){tdcNotice._errorNotices.forEach(function(a,b){a.remove()})},init:function(){tdcNotice._isInitialized||(tdcNotice.$_noticeWrapper=b('<div class="tdc-notice-wrapper"></div>'),tdcNotice.$_noticeWrapper.on("click",".tdc-close-notice",function(a){b(this).closest(".tdc-notice").remove()}),b("#tdc-live-iframe-wrapper").append(tdcNotice.$_noticeWrapper),
tdcNotice._isInitialized=!0)}};tdcNotice.init()})(jQuery);var tdcShortcodeParser={};
(function(){tdcShortcodeParser={levels:{},init:function(b){tdcShortcodeParser.levels=_.clone(b);tdcShortcodeParser.levels[3]=tdcShortcodeParser.levels[3].concat(tdcShortcodeParser.levels[5])},multiNext:function(b,d){b=tdcShortcodeParser.levels[b];for(var a,c=0;c<b.length;c++){var e=tdcShortcodeParser.generateTreeElement(wp.shortcode.next(b[c],d));"undefined"!==typeof e&&("undefined"===typeof a||a.index>e.index)&&(a=e)}return a},parse:function(b,d){for(var a=tdcShortcodeParser.multiNext(b,d),c=0,e=
[];"undefined"!==typeof a&&5E3>c;)d=d.substring(a.index+a.content.length),5>b&&(a.child=tdcShortcodeParser.parse(b+1,a.content)),e.push(a),a=tdcShortcodeParser.multiNext(b,d),c++;return e},generateTreeElement:function(b){return b}}})();var tdcInit={};
(function(b,d,a){tdcInit={$formPost:a,_title:"TagDiv Composer Draft",_url:"",$title:a,$titlePromptText:a,$contentWrap:a,$content:a,$contentIfr:a,$originalPostStatus:a,$_wpnonce:a,$postType:a,$postId:a,$postAuthor:a,$excerpt:a,$catslist:a,catslistValue:"",init:function(){tdcInit.$formPost=b("#post");if(tdcInit.$formPost.length){tdcInit.$title=tdcInit.$formPost.find("#title");tdcInit.$titlePromptText=tdcInit.$formPost.find("#title-prompt-text");tdcInit.$contentWrap=tdcInit.$formPost.find("#wp-content-wrap");
tdcInit.$content=tdcInit.$formPost.find("#content");tdcInit.$contentIfr=tdcInit.$formPost.find("#content_ifr");tdcInit.$originalPostStatus=tdcInit.$formPost.find("#original_post_status");tdcInit.$_wpnonce=tdcInit.$formPost.find("#_wpnonce");tdcInit.$postType=tdcInit.$formPost.find("#post_type");tdcInit.$postId=tdcInit.$formPost.find("#post_ID");tdcInit.$postAuthor=tdcInit.$formPost.find("#post_author");tdcInit.$excerpt=tdcInit.$formPost.find("#excerpt");tdcInit.$catslist=tdcInit.$formPost.find("input[type=checkbox][name^=post_category]");
d.each(tdcInit.$catslist,function(a,c,d){a=b(a);a.is(":checked")&&(tdcInit.catslistValue+=a.val()+",")});var a="page";tdcInit.$tdbTemplateType=tdcInit.$formPost.find("#tdb-template-type");tdcInit.$tdbTemplateType.length&&(a=tdcInit.$tdbTemplateType.val());tdcInit._url=window.tdcAdminSettings.adminUrl+"post.php?post_id="+tdcInit.$postId.val()+"&td_action=tdc&tdbTemplateType="+a;"footer"===a||"page"!==tdcInit.$postType.val()&&"tdb_templates"!==tdcInit.$postType.val()||!0!==window.tdcAdminSettings.hasUserRights||
window.tdcAdminSettings.isPageForPosts||b('<div class="tdc-panel-button"><div class="tdc-panel-icon"></div><div class="tdc-panel-link"><a onclick="return tdcInit.savePost( event )" href="'+tdcInit._url+'">TagDiv Composer</a></div></div>').insertAfter("div#titlediv")}},_checkPostContent:function(){tdcInit.$title.length&&tdcInit.$titlePromptText.length&&0===tdcInit.$title.val().trim().length&&(tdcInit.$title.val(tdcInit._title),tdcInit.$titlePromptText.hide());tdcShortcodeParser.init({0:["tdc_zone"],
1:["vc_row"],2:["vc_column"],3:["vc_row_inner"],4:["vc_column_inner"],5:[]});return tdcInit.$contentWrap.hasClass("tmce-active")?tinyMCE.activeEditor.getContent():tdcInit.$formPost.find("#content").val()},savePost:function(a){b(".tdc-panel-button").addClass("tdc-open-editor-loader");setTimeout(function(){b(".tdc-panel-button").removeClass("tdc-open-editor-loader")},2E3);a=tdcInit._checkPostContent();b.ajax({url:window.ajaxurl,type:"POST",data:{"data[wp_autosave][post_id]":tdcInit.$postId.val(),"data[wp_autosave][post_type]":tdcInit.$postType.val(),
"data[wp_autosave][post_author]":tdcInit.$postAuthor.val(),"data[wp_autosave][post_title]":tdcInit.$title.val(),"data[wp_autosave][content]":a,"data[wp_autosave][excerpt]":tdcInit.$excerpt.val(),"data[wp_autosave][catslist]":tdcInit.catslistValue,"data[wp_autosave][auto_draft]":1,"data[wp_autosave][_wpnonce]":tdcInit.$_wpnonce.val(),interval:60,_nonce:window.heartbeatSettings.nonce,action:"heartbeat",screen_id:tdcInit.$postType.val(),has_focus:!1}}).done(function(a,b,c){window.location=tdcInit._url});
return!1}};b(window).ready(function(){tdcInit.init()})})(jQuery,_);var tdcDebug;
(function(b,d){tdcDebug={_debug:!0,_logWindowObj:d,_content:d,_disabled:!1,log:function(a){tdcDebug._debug&&console.log(a)},dumpAllItems:function(){var a=tdcAdminIFrameUI.getIframeWindow();console.group("All items dump:");"undefined"!==typeof a.tdcComposerBlocksApi&&(console.log("%c tdcComposerBlocksApi.items ","background: #222; color: white"),console.log(a.tdcComposerBlocksApi.items));"undefined"!==typeof a.tdPullDown&&(console.log("%c tdPullDown.items ","background: #222; color: white"),console.log(a.tdPullDown.items));
"undefined"!==typeof a.tdAnimationSprite&&(console.log("%c tdAnimationSprite.items ","background: #222; color: white"),console.log(a.tdAnimationSprite.items));"undefined"!==typeof a.tdHomepageFull&&(console.log("%c tdHomepageFull.items ","background: #222; color: white"),console.log(a.tdHomepageFull.items));"undefined"!==typeof a.tdTrendingNow&&(console.log("%c tdTrendingNow.items ","background: #222; color: white"),console.log(a.tdTrendingNow.items));console.groupEnd()},group:function(a,b){!1!==
tdcDebug._debug&&(console.group?console.group(a,b):console.log(a))},groupCollapsed:function(a,b){!1!==tdcDebug._debug&&(console.groupCollapsed?console.groupCollapsed(a,b):console.log(a))},groupEnd:function(){!1!==tdcDebug._debug&&console.groupEnd&&console.groupEnd()},logWindow:function(a){if(d===tdcDebug._logWindowObj){tdcDebug._logWindowObj=b("<div></div>");var c=b('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Clear</div>'),e=b('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Disable</div>');
tdcDebug._content=b('<div style="clear: both"></div>');tdcDebug._logWindowObj.append(c);tdcDebug._logWindowObj.append(e);c.click(function(a){tdcDebug._content.html("")});e.click(function(a){tdcDebug._disabled=!tdcDebug._disabled;tdcDebug._disabled?b(this).css("background-color","#FF000"):b(this).css("background-color","")});tdcDebug._logWindowObj.append(tdcDebug._content);b("body").append(tdcDebug._logWindowObj);tdcDebug._logWindowObj.css({width:300,height:500,border:"1px solid red",position:"fixed",
bottom:0,right:20,"background-color":"#FFFFFF",overflow:"scroll","z-index":1E4})}tdcDebug._disabled||tdcDebug._content.html(a+"<br>"+tdcDebug._content.html())}}})(jQuery);
